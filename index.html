<!DOCTYPE html>
<html>
    <title>REST Practice</title>
     <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <head>
        <link rel="stylesheet" type="text/css" href="main.css">
         <script>
            /* global $ */
            //category click function
            $(document).ready(function() {
                $('.category').click(function(e){
                    console.log($(e.currentTarget)[0].id);
                    var category = $(e.currentTarget)[0].id;
                    var response = getRandomFact(category);
                });
                
                //language toggle function
                $('.toggle').click(function(e){
                    var language = $(e.currentTarget)[0].id;
                    if(language == 'wookie'){
                        $("#wookie").addClass('selected');
                        $('#english').removeClass('selected')
                    } else if (language =='english'){
                        $("#english").addClass('selected');
                        $('#wookie').removeClass('selected')
                    }
                })
            });
            
            function getRandomFact(category){
                var myText = $('textInput').val();
                var maxInt = (category == "films") ? 7 : 36;
                var randInt = Math.floor(Math.random() * Math.floor(maxInt));
                console.log(randInt);
                var wookie = ($('#wookie').hasClass('selected')) ? "?format=wookiee" :  "";
                var myurl= "https://swapi.co/api/" + category + "/" + randInt + "/" + wookie;
                console.log(myurl);
                  $.ajax({
                    url : myurl,
                    crossDomain: true,
                    dataType: 'json',
                    //contentType: 'application/json',
                    success : function(parsed_json) {
                      console.log(parsed_json);
                      $("#output").html(parsed_json["name"]);
                      //TODO: get & display the rest of the info
                    },
                    error: function(e){
                        console.log("ERROR");
                        console.log(e.responseText);
                        //if error, run again with a new randomInt (bc some indexes randomly dont exist in the api)
                        if(e.responseText == '{"detail":"Not found"}'){
                            getRandomFact(category);
                        }
                        
                    }
                  });
                }
            
        </script>
    </head>
    <body>
        <div class="header">
            <img class="logo" src="star-wars.png" alt="STAR WARS">
            <h2>FACT GENERATOR</h2>
        </div>
        <div class="catTable">
           <div class="category" id="people"><span class="catText">People</span></div>
           <div class="category" id="planets"><span class="catText">Planets</span></div>
           <div class="category" id="starships"><span class="catText">Starships</span></div>
           <div class="category" id="species"><span class="catText">Species</span></div>
           <div class="category" id="films"><span class="catText">Films</span></div>
        </div>
        <div class="toggleContainer">
            Show result in: 
            <span class="toggle selected" id="english">English</span>
            <span class="toggle" id="wookie">Wookie</span>
        </div>
        <div id="output"></div>
    </body>

</html>